<app-layout>
  <div class="main-layout flex h-screen bg-gray-50 overflow-hidden">
    <!-- Mobile Menu Overlay -->
    <div *ngIf="showMobileMenu" 
         (click)="showMobileMenu = false"
         class="fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden"></div>

    <!-- Sidebar Container -->
    <div [class]="'sidebar-container shadow-sm border-r border-gray-200 flex flex-col z-30 transition-transform duration-300 ' + 
                  (showMobileMenu ? 'fixed inset-y-0 left-0 w-64 transform translate-x-0' : 
                   'fixed inset-y-0 left-0 w-64 transform -translate-x-full lg:relative lg:translate-x-0')">
      <!-- Header -->
      <div class="logo-section">
        <div class="logo">
          <img src="assets/icons/lucide/lucide/briefcase.svg" alt="Vendor Portal">
          <span>Vendor Portal</span>
        </div>
        <p class="text-xs text-gray-400 mt-1">
          <span *ngIf="currentUser?.firstName && currentUser?.lastName">
            {{currentUser?.firstName}} {{currentUser?.lastName}}
          </span>
          <span *ngIf="!currentUser?.firstName || !currentUser?.lastName">Loading...</span>
        </p>
      </div>

      <!-- Navigation Menu with Integrated Stats -->
      <nav class="nav-menu">
        <div *ngFor="let menuItem of getAvailableMenuItems()">
          <!-- Regular menu item -->
          <button
            *ngIf="!menuItem.hasSubmenu"
            (click)="navigateToTab(menuItem.id)"
            [class]="'nav-item ' + 
              (isActiveRoute(menuItem.route) ? 'active' : '')">
            <img [src]="'assets/icons/lucide/lucide/' + menuItem.icon" [alt]="menuItem.label">
            <span>{{menuItem.label}}</span>
          </button>

          <!-- Finance Management menu with submenu -->
          <div *ngIf="menuItem.hasSubmenu">
            <!-- Main Finance Management button -->
            <button
              (click)="toggleFinanceManagementSubmenu()"
              [class]="'nav-item ' + 
                (showFinanceManagementSubmenu ? 'active' : '')">
              <img [src]="'assets/icons/lucide/lucide/' + menuItem.icon" [alt]="menuItem.label">
              <span>{{menuItem.label}}</span>
              <img 
                [src]="'assets/icons/lucide/lucide/' + (showFinanceManagementSubmenu ? 'chevron-up.svg' : 'chevron-down.svg')" 
                class="chevron-rotate" 
                [class.expanded]="showFinanceManagementSubmenu"
                [alt]="showFinanceManagementSubmenu ? 'Collapse' : 'Expand'">
            </button>

            <!-- Submenu items -->
            <div *ngIf="showFinanceManagementSubmenu" class="submenu-container">
              <button
                *ngFor="let submenuItem of menuItem.submenu"
                (click)="navigateToTab(submenuItem.id)"
                [class]="'submenu-item ' + 
                  (isActiveRoute(submenuItem.route) ? 'active' : '')">
                <div class="submenu-dot"></div>
                <span>{{submenuItem.label}}</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Stats Summary - Integrated into Navigation Menu -->
        <div class="stats-section-integrated">
          <div class="space-y-2 sm:space-y-3">
            <div class="stat-item">
              <div class="stat-content">
                <div class="stat-icon bg-blue-100">
                  <img src="assets/icons/lucide/lucide/users.svg" class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600" alt="Resources">
                </div>
                <span class="stat-title">Resources</span>
              </div>
              <span class="stat-value">--</span>
            </div>
            <div class="stat-item">
              <div class="stat-content">
                <div class="stat-icon bg-green-100">
                  <img src="assets/icons/lucide/lucide/briefcase.svg" class="w-3 h-3 sm:w-4 sm:h-4 text-green-600" alt="Requirements">
                </div>
                <span class="stat-title">Requirements</span>
              </div>
              <span class="stat-value">--</span>
            </div>
            <div class="stat-item">
              <div class="stat-content">
                <div class="stat-icon bg-purple-100">
                  <img src="assets/icons/lucide/lucide/trending-up.svg" class="w-3 h-3 sm:w-4 sm:h-4 text-purple-600" alt="Applications">
                </div>
                <span class="stat-title">Applications</span>
              </div>
              <span class="stat-value">--</span>
            </div>
          </div>
        </div>
      </nav>
    </div>

    <!-- Right Content Container -->
    <div class="content-container flex-1 flex flex-col relative z-10">
      <!-- Mobile Header -->
      <div class="lg:hidden bg-white border-b border-gray-200 px-4 py-3">
        <div class="flex items-center justify-between">
          <button
            (click)="showMobileMenu = true"
            class="mobile-menu-btn p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg">
            <img src="assets/icons/lucide/lucide/list.svg" class="w-5 h-5" alt="Menu">
          </button>
          <h1 class="text-lg font-bold text-gray-900">Vendor Portal</h1>
          <div class="w-9"></div> <!-- Spacer for centering -->
        </div>
      </div>

      <!-- Content Area with Router Outlet -->
      <div class="content-area flex-1 overflow-y-auto overflow-x-hidden">
        <router-outlet></router-outlet>
      </div>
    </div>
  </div>
</app-layout>