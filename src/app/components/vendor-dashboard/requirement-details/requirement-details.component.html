<div class="min-h-screen bg-gray-50 py-6">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header with Back Button -->
    <div class="mb-8">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-4">
          <button 
            (click)="onBack()"
            class="flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors">
            <img src="assets/icons/lucide/lucide/arrow-left.svg" alt="back" class="w-5 h-5" />
            <span class="text-sm font-medium">Back to Requirements</span>
          </button>
        </div>
        <div class="flex items-center gap-2">
          <span class="text-sm text-gray-500">Requirement Details</span>
        </div>
      </div>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
      <div class="flex items-center gap-2">
        <img src="assets/icons/lucide/lucide/alert-circle.svg" alt="error" class="w-5 h-5 text-red-600" />
        <span class="text-sm text-red-800">{{ errorMessage }}</span>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="flex items-center justify-center py-12">
      <div class="text-center">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"></div>
        <p class="text-gray-600">Loading requirement details...</p>
      </div>
    </div>

        <!-- Requirement Details -->
    <div *ngIf="requirement && !isLoading" class="space-y-4">
      <!-- Main Requirement Card -->
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <!-- Header -->
        <div class="flex items-start justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-gradient-to-br from-green-100 to-emerald-100 rounded-lg flex items-center justify-center">
              <img src="assets/icons/lucide/lucide/file-text.svg" alt="requirement" class="w-5 h-5 text-green-600" />
            </div>
            <div>
              <h1 class="text-xl font-bold text-gray-900 mb-1">{{ requirement.title }}</h1>
              <div class="flex items-center gap-2 text-sm">
                <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                  {{ getCategoryName(requirement.category) }}
                </span>
                <div class="flex items-center gap-1">
                  <div class="w-2 h-2 rounded-full" 
                       [class]="requirement.status === 'open' ? 'bg-green-500' : 'bg-gray-400'"></div>
                  <span class="text-gray-600 capitalize">{{ requirement.status }}</span>
                </div>
                <span class="text-gray-500">â€¢ {{ requirement.createdAt | date:'shortDate' }}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Description -->
        <div *ngIf="requirement.description" class="mb-4">
          <h3 class="text-sm font-semibold text-gray-900 mb-2">Description</h3>
          <div class="bg-gray-50 rounded-lg p-3">
            <p class="text-gray-700 text-sm leading-relaxed whitespace-pre-wrap">{{ requirement.description }}</p>
          </div>
        </div>

        <!-- Key Details Grid -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
          <!-- Budget -->
          <div class="bg-gray-50 rounded-lg p-3">
            <div class="flex items-center gap-2 mb-1">
              <img src="assets/icons/lucide/lucide/dollar-sign.svg" alt="budget" class="w-4 h-4 text-green-600" />
              <span class="text-xs font-medium text-gray-500">Budget</span>
            </div>
            <p class="text-sm font-semibold text-gray-900">
              {{ requirement.budget.currency || 'USD' }}{{ requirement.budget.charge || 0 }}/hr
            </p>
            <p class="text-xs text-gray-500">{{ requirement.budget.type || 'Not specified' }}</p>
          </div>

          <!-- Duration -->
          <div class="bg-gray-50 rounded-lg p-3">
            <div class="flex items-center gap-2 mb-1">
              <img src="assets/icons/lucide/lucide/clock.svg" alt="duration" class="w-4 h-4 text-blue-600" />
              <span class="text-xs font-medium text-gray-500">Duration</span>
            </div>
            <p class="text-sm font-semibold text-gray-900">{{ requirement.duration || 'Not specified' }}</p>
          </div>

          <!-- Location -->
          <div class="bg-gray-50 rounded-lg p-3">
            <div class="flex items-center gap-2 mb-1">
              <img src="assets/icons/lucide/lucide/map-pin.svg" alt="location" class="w-4 h-4 text-purple-600" />
              <span class="text-xs font-medium text-gray-500">Location</span>
            </div>
            <p class="text-sm font-semibold text-gray-900">{{ getLocationDisplay(requirement.location) }}</p>
            <p *ngIf="requirement.location?.remote" class="text-xs text-blue-600">Remote available</p>
          </div>

          <!-- Experience -->
          <div class="bg-gray-50 rounded-lg p-3">
            <div class="flex items-center gap-2 mb-1">
              <img src="assets/icons/lucide/lucide/user-check.svg" alt="experience" class="w-4 h-4 text-orange-600" />
              <span class="text-xs font-medium text-gray-500">Experience</span>
            </div>
            <p class="text-sm font-semibold text-gray-900">{{ requirement.experience.minYears || 0 }} years</p>
            <p class="text-xs text-gray-500">{{ requirement.experience.level || 'Not specified' }}</p>
          </div>
        </div>

        <!-- Skills Section -->
        <div *ngIf="requirement.skills && requirement.skills.length > 0" class="mb-4">
          <h3 class="text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2">
            <img src="assets/icons/lucide/lucide/target.svg" alt="skills" class="w-4 h-4 text-purple-600" />
            Required Skills
          </h3>
          <div class="flex flex-wrap gap-2">
            <span *ngFor="let skill of requirement.skills" 
                  class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-50 text-purple-700 border border-purple-200">
              {{ getSkillName(skill) }}
            </span>
          </div>
        </div>

        <!-- Client & Timeline Info -->
        <div class="grid grid-cols-2 gap-4 mb-4">
          <div class="bg-gray-50 rounded-lg p-3">
            <div class="flex items-center gap-2 mb-1">
              <img src="assets/icons/lucide/lucide/building.svg" alt="client" class="w-4 h-4 text-teal-600" />
              <span class="text-xs font-medium text-gray-500">Client</span>
            </div>
            <p class="text-sm font-semibold text-gray-900">{{ getClientName() }}</p>
            <p class="text-xs text-gray-500">{{ getContactPerson() }}</p>
            <p class="text-xs text-gray-500">{{ getContactEmail() }}</p>
          </div>

          <div class="bg-gray-50 rounded-lg p-3">
            <div class="flex items-center gap-2 mb-1">
              <img src="assets/icons/lucide/lucide/calendar.svg" alt="timeline" class="w-4 h-4 text-indigo-600" />
              <span class="text-xs font-medium text-gray-500">Timeline</span>
            </div>
            <p class="text-sm font-semibold text-gray-900">{{ requirement.startDate | date:'shortDate' || 'Not specified' }}</p>
            <p class="text-xs text-gray-500 capitalize">{{ requirement.status }}</p>
          </div>
        </div>

        <!-- Attachment Section -->
        <div>
          <h3 class="text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2">
            <img src="assets/icons/lucide/lucide/paperclip.svg" alt="attachment" class="w-4 h-4 text-gray-600" />
            Attachments
          </h3>
          
          <div *ngIf="requirement.attachment?.fileId || requirement.attachment?.filename; else noAttachment" class="bg-gray-50 rounded-lg p-3">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-2">
                <img [src]="getFileTypeIcon(requirement.attachment?.fileType || '')" alt="file" class="w-6 h-6 text-gray-600" />
                <div>
                  <p class="text-sm font-medium text-gray-900">{{ requirement.attachment?.originalName || 'Unknown file' }}</p>
                  <p class="text-xs text-gray-500">{{ formatFileSize(requirement.attachment?.fileSize || 0) }}</p>
                </div>
              </div>
              <div class="flex items-center gap-2">
                <button 
                  (click)="onViewAttachment()"
                  class="inline-flex items-center px-2 py-1 rounded text-xs font-medium text-blue-700 bg-blue-50 border border-blue-300 hover:bg-blue-100 transition-colors">
                  <img src="assets/icons/lucide/lucide/eye.svg" alt="view" class="w-3 h-3 mr-1" />
                  {{ isPdfFile(requirement.attachment?.fileType) ? 'View Inline' : 'View' }}
                </button>
                <button 
                  (click)="onDownloadAttachment()"
                  class="inline-flex items-center px-2 py-1 rounded text-xs font-medium text-green-700 bg-green-50 border border-green-300 hover:bg-green-100 transition-colors">
                  <img src="assets/icons/lucide/lucide/download.svg" alt="download" class="w-3 h-3 mr-1" />
                  Download
                </button>
              </div>
            </div>
          </div>
          
          <ng-template #noAttachment>
            <div class="bg-gray-50 rounded-lg p-4 text-center">
              <img src="assets/icons/lucide/lucide/file-x.svg" alt="no attachment" class="w-8 h-8 text-gray-400 mx-auto mb-2" />
              <p class="text-sm text-gray-500">No attachment available</p>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>

  <!-- Embedded Document Viewer Modal -->
  <div *ngIf="showEmbeddedViewer" class="fixed inset-0 z-50 overflow-hidden">
    <!-- Backdrop -->
    <div class="absolute inset-0 bg-black bg-opacity-75" (click)="closeEmbeddedViewer()"></div>
    
    <!-- Modal Content -->
    <div class="relative z-10 flex items-center justify-center min-h-screen p-4">
      <div class="bg-white rounded-xl shadow-2xl w-full max-w-6xl h-[90vh] flex flex-col">
        <!-- Header -->
        <div class="flex items-center justify-between p-4 border-b border-gray-200">
          <div class="flex items-center gap-3">
            <img [src]="getFileTypeIcon(requirement?.attachment?.fileType || '')" alt="file" class="w-6 h-6 text-gray-600" />
            <div>
              <h3 class="text-lg font-semibold text-gray-900">{{ requirement?.attachment?.originalName || 'Document' }}</h3>
              <p class="text-sm text-gray-500">{{ formatFileSize(requirement?.attachment?.fileSize || 0) }}</p>
            </div>
          </div>
          <div class="flex items-center gap-2">
            <button 
              (click)="onDownloadAttachment()"
              class="inline-flex items-center px-3 py-2 rounded-lg text-sm font-medium text-green-700 bg-green-50 border border-green-300 hover:bg-green-100 transition-colors">
              <img src="assets/icons/lucide/lucide/download.svg" alt="download" class="w-4 h-4 mr-2" />
              Download
            </button>
            <button 
              (click)="closeEmbeddedViewer()"
              class="inline-flex items-center justify-center w-10 h-10 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors">
              <img src="assets/icons/lucide/lucide/x.svg" alt="close" class="w-5 h-5" />
            </button>
          </div>
        </div>
        
        <!-- Document Viewer -->
        <div class="flex-1 p-4">
          <div class="w-full h-full border border-gray-200 rounded-lg overflow-hidden">
            <!-- PDF Viewer -->
            <iframe 
              *ngIf="isPdfFile(requirement?.attachment?.fileType)"
              [src]="embeddedViewerUrl | safe"
              class="w-full h-full"
              frameborder="0">
            </iframe>
            
            <!-- Placeholder for non-PDF files -->
            <div *ngIf="!isPdfFile(requirement?.attachment?.fileType)" class="flex items-center justify-center h-full">
              <div class="text-center">
                <img src="assets/icons/lucide/lucide/file-x.svg" alt="file not supported" class="w-16 h-16 text-gray-400 mx-auto mb-4" />
                <p class="text-gray-600 mb-2">This file type cannot be viewed inline</p>
                <p class="text-sm text-gray-500">Please use the download button to view this file</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 